---
# Dokument Informationen
title: "Latex, YAML, RMarkdown"
subtitle: "Options, packages and examples for PDF print"
email: "info.statistik@stadtdo.de"
author: "Dortmunder Statistik"
# abstract:
# subject:
# category: 
# abstract:
# lot: no # Tabellenverzeichnis
# lof: no # Abbildungsverzeichnis

  
# Schrift
mainfont: "Verdana"
# sansfont:
# monofont:
# mathfont:
linkcolor: "blue"
urlcolor: "gray"

  
# Layout Optionen
# margin_left: 
# margin_right:
papersize: "A4"
classoption: "twoside" # für unterschiedliche gerade und ungerade Seitenformatierungen

# Latex Optionen
header-includes:
  # Mehrspaltiges Layout
  # Abstand zwischen Spalten
  - \setlength{\columnsep}{18pt}
  # multicol - package für mehrspaltige Layouts
  - \usepackage{multicol}
  # Work around für pandoc markdown
  # https://stackoverflow.com/questions/40982836/latex-multicolumn-block-in-pandoc-markdown
  - \newcommand{\hideFromPandoc}[1]{#1} 
  - \hideFromPandoc{
      \let\Begin\begin
      \let\End\end
      }
      
  # Farbpalette    
  - \definecolor{DoStat}{RGB}{4, 72, 145} # Farbdefinitionen zur weiteren Verwendung in YAML mit package xcolor (standardmäßig geladen)
  
  # fancyhdr: Kopf- und Fußzeilen Einstellungen
  - \usepackage{fancyhdr}
  - \pagestyle{fancy}
  - \fancyhf{}
  - \fancyhead[LE]{\itshape\nouppercase{\color{DoStat}\leftmark}}
  - \fancyhead[RO]{\itshape\nouppercase{\color{DoStat}\leftmark}}
  - \fancyfoot[LE]{\color{DoStat} \thepage \hspace{0.5cm} dortmunder\textbf{statistik}  • nr. 211 • jahresbericht 2018 • bevölkerung}
  - \fancyfoot[RO]{\color{DoStat} dortmunder\textbf{statistik}  • nr. 211 • jahresbericht 2018 • bevölkerung \hspace{0.5cm} \thepage}
  # - \renewcommand{\headrulewidth}{0.4pt}
  # - \renewcommand{\footrulewidth}{0.4pt}
  - \usepackage{graphicx} # für includegraphics

output: 
  bookdown::pdf_document2:
    # extra_dependencies: ["xcolor", "multicol"] # Verwendete Latex packages, Alternative zu \usepackage
    # clean: # remove intermediate files
    keep_tex: true # wirft zusätzlich eine .tex Datei aus
    latex_engine: "xelatex" # erlaubt die Verwnedung lokal installierter Schrifttypen
    # Inhaltsverzeichnis
    toc: true
    toc_depth: 4 # wieviele Überschriftsebenen sollen im Inhaltsverzeichnis angezeigt werden
  toc-title: "Titel Inhaltsverzeichnis"


---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, out.width = '100%', dpi=300)
```


```{r echo = FALSE, message=FALSE}
library(tidyverse) # import/wrangle
library(ggplot2) # plot/maps
library(tmap) # Dataset/Maps
library(kableExtra) # tables
library(viridis) # palettes
library(bookdown) 
```


```{r echo = FALSE}
data("World")

# Data mit geometry
WorldGeom <- World
# Data ohne
WorldData <- World %>% 
  sf::st_drop_geometry()
```
\newpage

\Begin{multicols}{2}
# Wiki

## Allgemeines

### YAML settings Übersicht

- rmarkdown::default_output_format() zeigt die aktuelle YAML output Konfiguration

```{r echo = FALSE}
rmarkdown::default_output_format("./PDF_Latex.Rmd", output_yaml = TRUE)
```

### Template Info

[R Markdown Document Templates](https://rstudio.github.io/rstudio-extensions/rmarkdown_templates.html)

[Latex engines](https://tex.stackexchange.com/questions/36/differences-between-luatex-context-and-xetex)

### Bücher/Präsentationen

[RMarkdown for Scientists](https://rmd4sci.njtierney.com/)

[Publication Quality Reports with knitr](https://warwick.ac.uk/fac/sci/wdsi/events/vacationschool2016/for-participants/materials/knitr.pdf)

## packages

### R

#### rticles - Vorlagen
Templates und Vorlagen wissenschaftlicher Journals

[rtcles](https://github.com/rstudio/rticles)


#### captionier - individuelle Tabellen und Grafik Tags

[Dokumenation](https://www.rdocumentation.org/packages/captioner/versions/2.2.3)

[stackoverflow Thread mit Beispielen](https://stackoverflow.com/questions/51945079/how-to-change-the-figure-caption-format-in-bookdow)

#### ymlthis- YAML package

package zur vereinfachten Verwendung von YAML in RMarkdown und bookdown

[Reference Manual](https://cran.r-project.org/web/packages/ymlthis/ymlthis.pdf)

[YAML Field Guide](https://cran.r-project.org/web/packages/ymlthis/vignettes/yaml-fieldguide.html)

[yml_latex.R](https://github.com/r-lib/ymlthis/blob/master/R/yml_latex.R)

[yml_latex_opts - Set LaTeX YAML options for PDF output ](https://rdrr.io/github/r-lib/ymlthis/man/yml_latex_opts.html)

[yml_resource_files - Add external resource files to R Markdown document](https://www.rdocumentation.org/packages/ymlthis/versions/0.1.2/topics/yml_resource_files)

[yml_output - Capture, validate, and write output YAML](https://github.com/r-lib/ymlthis/blob/master/R/yml_output.R)

#### bookdown

Authoring Books and Technical Documents with R Markdown

Single Page Documents https://bookdown.org/yihui/bookdown/a-single-document.html

customization https://bookdown.org/yihui/bookdown/customization.html


### Latex

#### Multicol - mehrspaltige Layouts
https://www.ctan.org/pkg/multicol

https://tex.stackexchange.com/questions/8683/how-do-i-force-a-column-break-in-a-multi-column-page

https://stackoverflow.com/questions/40982836/latex-multicolumn-block-in-pandoc-markdown

column length 
https://tex.stackexchange.com/questions/61624/adjusting-column-width-in-latex-with-the-multicol-package

Mögliche Lösungen für 2 Spalten:
https://github.com/yihui/rmarkdown-cookbook/issues/19

Alternativen:

https://stackoverflow.com/questions/34808612/how-make-2-column-layout-in-r-markdown-when-rendering-pdf

#### geometry - Dokumentformatierung

[Flexible and complete interface to document dimensions](https://ctan.org/pkg/geometry?lang=en)

[Dokumentation](http://mirrors.ctan.org/macros/latex/contrib/geometry/geometry-de.pdf)

ymlthis::yml_latex_opts() erlaubt die Einstellung über das package ymlthis zu konfigurieren


#### pdfpages - Einbindung externe PDF

[Einbindung von PDF Dokumenten in Latex](https://ctan.org/pkg/pdfpages)

- ggf. eine Lösung für Umschlag?

#### KOMA Script - Sammlung

[package und class Sammlung](https://www.ctan.org/pkg/koma-script)

[inkl. Fußnoten package (z.Z. wird aber fancyhdr bevorzugt)](https://ctan.org/pkg/scrlayer-scrpage?lang=de)

#### fancyhdr - Kopf- /Fußzeile

[Kopf- und Fußzeilen](https://ctan.org/pkg/fancyhdr?lang=de)

[User Guide](http://tug.ctan.org/tex-archive/macros/latex/contrib/fancyhdr/fancyhdr.pdf)

[Abschnitt aus "bookdown](https://bookdown.org/yihui/rmarkdown-cookbook/latex-header.html)


#### fontspec - Schrift

[Erweiterte Schrift Auswahl und Konfiguration](https://www.ctan.org/pkg/fontspec)

#### Inhaltsverzeichnisse

##### tocloft - TOC

[Erweiterte Optionen für Inhaltsverzeichnisse](https://www.ctan.org/pkg/tocloft)

Beispiel https://www.kronto.org/thesis/tips/format-toc.html

##### enumitem - TOC

[Manuelle Definition von TOCs](https://ctan.org/pkg/enumitem?lang=de)

#### titlesec - Überschriften

[Erweiterte Optionen für Überschriften](https://ctan.org/pkg/titlesec?lang=de)


#### caption - Tabellenüberschriften

[Formiertung für Tabellen oder Grafik Überschriften](https://ctan.org/pkg/caption?lang=de)

##### Beispiele

- https://tex.stackexchange.com/questions/225943/how-to-create-a-custom-table-of-contents
- https://tex.stackexchange.com/questions/404103/customize-the-table-of-contents
- https://cmry.github.io/notes/latextoc - Sektionen ohne Nummerierung
- https://www.kronto.org/thesis/tips/format-toc.html

\End{multicols}

\newpage



## Formatierung

### Pandoc Variablen

[Anleitung](https://pandoc.org/MANUAL.html#variables-for-latex)


### Schriften

[Schrift Katalog](https://tug.org/FontCatalogue/)

### Seitenwechsel 

Latex Page Breaks https://web.archive.org/web/20100622022829/http://help-csli.stanford.edu/tex/latex-pagebreaks.shtml


### Logo für Titelseiten

https://bookdown.org/yihui/rmarkdown-cookbook/latex-logo.html#latex-logo

Über includegraphics, Alternative siehe Latex package pdfpages 

### Nicht nummerierte Kapitel

https://bookdown.org/yihui/rmarkdown-cookbook/unnumbered-sections.html


### Inhaltsverzeichnis

[10 Wege Inhaltsverzeichnisse zu formatieren](https://texblog.org/2011/09/09/10-ways-to-customize-tocloflot/)


### Farbpaletten

Neben frei zu definierenden Farben (siehe YAML xcolor settings, bzw. für [Farbennamen](https://www.latextemplates.com/svgnames-colors) können Farben aus der Farbpalette ausgewählt werden


\includegraphics{latexcolor.png}

### Allgemeine Hinweise

- Zeilenumbruch mit neuem Abschnitt: In Markdown muss eine zusätzlicher Zeilenumbruch eingefügt werden, 

um diesen zu erzeugen. Es entsteht ein erhöhter Zeilenabstand.

- Zeilenumbruch ohne neuen Abschitt: man fügt 2 Leerzeichen in der Zeile ein,  
in der der Umbruch stattfinden soll

- ein Spaltenumbruch in einem mehrspaltigen Layout wird mit "columnbreak" erzeugt



\newpage

# Beispiele

## Gemischtes 1 und 2 Spalten Layout

\Begin{multicols}{2}
```{r echo = FALSE}
WorldData %>% 
  select(
    name,
    pop_est) %>% 
  arrange(desc(pop_est)) %>% 
  head(5) %>% 
  ggplot() + 
  geom_col(aes(x = pop_est, y = forcats::fct_reorder(name, pop_est))) +
  xlab("Bevölkerung") +
  ylab("")

```

Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.
\columnbreak

```{r echo = FALSE}

WorldData %>% 
  select(
    name,
    pop_est) %>% 
  arrange(desc(pop_est)) %>% 
  head(5) %>% 
  ggplot() + 
  geom_col(aes(x = pop_est, y = forcats::fct_reorder(name, pop_est))) +
  xlab("Bevölkerung") +
  ylab("") +
  theme(axis.text=element_text(size=12),
        axis.title=element_text(size=14,face="bold"))

```

Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.

\End{multicols}

Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.


```{r echo = FALSE}
WorldData %>% 
  select(
    continent,
    pop_est_dens,
    gdp_cap_est,
    life_exp,
    well_being,
    inequality,
    HPI) %>% 
  group_by(continent) %>% 
  summarise(
    across(
      pop_est_dens:HPI, 
      ~round(
        mean(., na.rm = TRUE)
        ,1))) %>% 
  filter(!is.na(well_being)) %>% 
  kableExtra::kbl(
    col.names = c(
      "Kontinent",
      "Bevölkerungsdichte",
      "BIP (pro Kopf)",
      "Lebenserwartung",
      "Wohlbefinden",
      "Ungleichheit",
      "Happy Planet"),
    booktabs = T) %>% 
  kableExtra::add_header_above(c(
    " " = 4, 
    "Index" = 3)) %>% 
  kableExtra::kable_styling(latex_options = c(
    "striped",
    "scale_down",
    "reapeat_header"))

```